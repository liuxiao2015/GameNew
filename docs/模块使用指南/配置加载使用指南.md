# é…ç½®åŠ è½½ä½¿ç”¨æŒ‡å—

> **æ¨¡å—**: `common-config`  
> **åŠŸèƒ½**: æ¸¸æˆé…ç½®è¡¨åŠ è½½ä¸çƒ­æ›´æ–°  
> **ç‰ˆæœ¬**: v1.0

---

## ğŸ“š ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [é…ç½®ç±»å®šä¹‰](#é…ç½®ç±»å®šä¹‰)
3. [é…ç½®å®¹å™¨](#é…ç½®å®¹å™¨)
4. [é…ç½®åŠ è½½](#é…ç½®åŠ è½½)
5. [é…ç½®çƒ­æ›´æ–°](#é…ç½®çƒ­æ›´æ–°)
6. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## æ¦‚è¿°

é…ç½®åŠ è½½ç³»ç»Ÿç”¨äºç®¡ç†æ¸¸æˆé…ç½®è¡¨ï¼ˆç­–åˆ’è¡¨ï¼‰ï¼š

| ç‰¹æ€§ | è¯´æ˜ |
|-----|------|
| **è‡ªåŠ¨åŠ è½½** | å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½æ‰€æœ‰é…ç½® |
| **çƒ­æ›´æ–°** | è¿è¡Œæ—¶é‡æ–°åŠ è½½é…ç½®ï¼Œæ— éœ€é‡å¯ |
| **ç±»å‹å®‰å…¨** | å¼ºç±»å‹é…ç½®ç±»ï¼Œç¼–è¯‘æœŸæ£€æŸ¥ |
| **ç´¢å¼•æ”¯æŒ** | æ”¯æŒå¤šç§ç´¢å¼•æ–¹å¼å¿«é€ŸæŸ¥è¯¢ |
| **é›†ç¾¤åŒæ­¥** | é…ç½®æ›´æ–°è‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰æœåŠ¡ |

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é…ç½®åŠ è½½æµç¨‹                            â”‚
â”‚                                                              â”‚
â”‚  JSONæ–‡ä»¶ â”€â”€â–º ConfigLoader â”€â”€â–º ConfigContainer â”€â”€â–º ä¸šåŠ¡ä»£ç   â”‚
â”‚                    â”‚                                         â”‚
â”‚                    â–¼                                         â”‚
â”‚             Spring Bean                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é…ç½®ç›®å½•ç»“æ„ï¼š
config/
â”œâ”€â”€ item.json          # ç‰©å“é…ç½®
â”œâ”€â”€ level.json         # ç­‰çº§é…ç½®
â”œâ”€â”€ monster.json       # æ€ªç‰©é…ç½®
â”œâ”€â”€ global.json        # å…¨å±€é…ç½®
â””â”€â”€ ...
```

---

## é…ç½®ç±»å®šä¹‰

### 1. åŸºç¡€é…ç½®ç±»

```java
package com.game.config.config;

import com.game.core.config.game.GameConfig;
import lombok.Data;

/**
 * ç‰©å“é…ç½®
 * <p>
 * å¯¹åº” config/item.json
 * </p>
 */
@Data
public class ItemConfig implements GameConfig {
    
    /** ç‰©å“ID (å”¯ä¸€æ ‡è¯†) */
    private int id;
    
    /** ç‰©å“åç§° */
    private String name;
    
    /** ç‰©å“ç±»å‹ (1=é“å…· 2=è£…å¤‡ 3=ææ–™ 4=æ¶ˆè€—å“) */
    private int type;
    
    /** ç‰©å“å“è´¨ (1=ç™½ 2=ç»¿ 3=è“ 4=ç´« 5=æ©™) */
    private int quality;
    
    /** æœ€å¤§å †å æ•°é‡ */
    private int maxStack;
    
    /** å‡ºå”®ä»·æ ¼ */
    private int sellPrice;
    
    /** æ˜¯å¦å¯äº¤æ˜“ */
    private boolean tradeable;
    
    /** ä½¿ç”¨æ•ˆæœ (JSONæ ¼å¼) */
    private String effect;
    
    /** å›¾æ ‡èµ„æº */
    private String icon;
    
    /** æè¿° */
    private String desc;

    // ==================== ä¾¿æ·æ–¹æ³• ====================

    public boolean isStackable() {
        return maxStack > 1;
    }

    public boolean isEquipment() {
        return type == 2;
    }

    public boolean isConsumable() {
        return type == 4;
    }
}
```

### 2. ç­‰çº§é…ç½®

```java
package com.game.config.config;

import com.game.core.config.game.GameConfig;
import lombok.Data;

/**
 * ç­‰çº§é…ç½®
 */
@Data
public class LevelConfig implements GameConfig {
    
    /** ç­‰çº§ */
    private int id;
    
    /** å‡çº§æ‰€éœ€ç»éªŒ */
    private long expRequired;
    
    /** è§£é”åŠŸèƒ½åˆ—è¡¨ */
    private List<Integer> unlockFeatures;
    
    /** å±æ€§åŠ æˆ */
    private int attrBonus;
    
    /** æœ€å¤§ä½“åŠ› */
    private int maxEnergy;
}
```

### 3. å…¨å±€é…ç½®

```java
package com.game.config.config;

import com.game.core.config.game.GameConfig;
import lombok.Data;

/**
 * å…¨å±€é…ç½® (å•ä¾‹)
 */
@Data
public class GlobalConfig implements GameConfig {
    
    /** é…ç½®ID (å›ºå®šä¸º1) */
    private int id = 1;
    
    /** æ¸¸æˆåç§° */
    private String gameName;
    
    /** æœ€å¤§ç­‰çº§ */
    private int maxLevel;
    
    /** æ¯æ—¥ç™»å½•å¥–åŠ±ç‰©å“ID */
    private int dailyLoginRewardId;
    
    /** æ–°æ‰‹å¼•å¯¼å¼€å…³ */
    private boolean tutorialEnabled;
    
    /** VIPç­‰çº§ä¸Šé™ */
    private int maxVipLevel;
    
    /** å…¬ä¼šåˆ›å»ºæ‰€éœ€ç­‰çº§ */
    private int guildCreateLevel;
    
    /** å…¬ä¼šåˆ›å»ºæ¶ˆè€—é’»çŸ³ */
    private int guildCreateCost;
}
```

---

## é…ç½®å®¹å™¨

### 1. åŸºç¡€é…ç½®å®¹å™¨

```java
package com.game.config.container;

import com.game.config.config.ItemConfig;
import com.game.core.config.game.BaseConfigContainer;
import com.game.core.config.game.ConfigContainer;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

/**
 * ç‰©å“é…ç½®å®¹å™¨
 */
@Component
@ConfigContainer(file = "item.json", config = ItemConfig.class)
public class ItemConfigContainer extends BaseConfigContainer<ItemConfig> {

    /** æŒ‰ç±»å‹ç´¢å¼• */
    private Map<Integer, List<ItemConfig>> byType;
    
    /** æŒ‰å“è´¨ç´¢å¼• */
    private Map<Integer, List<ItemConfig>> byQuality;

    @Override
    protected void buildIndex() {
        // æ„å»ºç±»å‹ç´¢å¼•
        byType = getAll().stream()
                .collect(Collectors.groupingBy(ItemConfig::getType));
        
        // æ„å»ºå“è´¨ç´¢å¼•
        byQuality = getAll().stream()
                .collect(Collectors.groupingBy(ItemConfig::getQuality));
    }

    // ==================== æŸ¥è¯¢æ–¹æ³• ====================

    /**
     * æ ¹æ®IDè·å–ç‰©å“é…ç½®
     */
    public ItemConfig getItem(int itemId) {
        return get(itemId);
    }

    /**
     * è·å–æŒ‡å®šç±»å‹çš„æ‰€æœ‰ç‰©å“
     */
    public List<ItemConfig> getByType(int type) {
        return byType.getOrDefault(type, List.of());
    }

    /**
     * è·å–æŒ‡å®šå“è´¨çš„æ‰€æœ‰ç‰©å“
     */
    public List<ItemConfig> getByQuality(int quality) {
        return byQuality.getOrDefault(quality, List.of());
    }

    /**
     * è·å–æ‰€æœ‰è£…å¤‡
     */
    public List<ItemConfig> getAllEquipments() {
        return getByType(2);
    }

    /**
     * è·å–æ‰€æœ‰æ¶ˆè€—å“
     */
    public List<ItemConfig> getAllConsumables() {
        return getByType(4);
    }

    /**
     * åˆ¤æ–­ç‰©å“æ˜¯å¦å­˜åœ¨
     */
    public boolean exists(int itemId) {
        return get(itemId) != null;
    }
}
```

### 2. ç­‰çº§é…ç½®å®¹å™¨

```java
package com.game.config.container;

import com.game.config.config.LevelConfig;
import com.game.core.config.game.BaseConfigContainer;
import com.game.core.config.game.ConfigContainer;
import org.springframework.stereotype.Component;

/**
 * ç­‰çº§é…ç½®å®¹å™¨
 */
@Component
@ConfigContainer(file = "level.json", config = LevelConfig.class)
public class LevelConfigContainer extends BaseConfigContainer<LevelConfig> {

    private int maxLevel;
    private long totalExpToMax;

    @Override
    protected void buildIndex() {
        // è®¡ç®—æœ€å¤§ç­‰çº§
        maxLevel = getAll().stream()
                .mapToInt(LevelConfig::getId)
                .max()
                .orElse(1);
        
        // è®¡ç®—å‡æ»¡çº§æ€»ç»éªŒ
        totalExpToMax = getAll().stream()
                .mapToLong(LevelConfig::getExpRequired)
                .sum();
    }

    // ==================== æŸ¥è¯¢æ–¹æ³• ====================

    /**
     * è·å–æœ€å¤§ç­‰çº§
     */
    public int getMaxLevel() {
        return maxLevel;
    }

    /**
     * è·å–æŒ‡å®šç­‰çº§çš„é…ç½®
     */
    public LevelConfig getLevel(int level) {
        return get(level);
    }

    /**
     * è·å–å‡çº§æ‰€éœ€ç»éªŒ
     */
    public long getExpRequired(int level) {
        LevelConfig config = get(level);
        return config != null ? config.getExpRequired() : Long.MAX_VALUE;
    }

    /**
     * æ ¹æ®ç»éªŒè®¡ç®—ç­‰çº§
     */
    public int calculateLevel(long totalExp) {
        int level = 1;
        long remainingExp = totalExp;
        
        for (LevelConfig config : getAll()) {
            if (remainingExp < config.getExpRequired()) {
                break;
            }
            remainingExp -= config.getExpRequired();
            level = config.getId();
        }
        
        return Math.min(level, maxLevel);
    }

    /**
     * è·å–æŒ‡å®šç­‰çº§çš„æœ€å¤§ä½“åŠ›
     */
    public int getMaxEnergy(int level) {
        LevelConfig config = get(level);
        return config != null ? config.getMaxEnergy() : 100;
    }
}
```

### 3. å…¨å±€é…ç½®å®¹å™¨ (å•ä¾‹)

```java
package com.game.config.container;

import com.game.config.config.GlobalConfig;
import com.game.core.config.game.BaseConfigContainer;
import com.game.core.config.game.ConfigContainer;
import org.springframework.stereotype.Component;

/**
 * å…¨å±€é…ç½®å®¹å™¨ (å•ä¾‹)
 */
@Component
@ConfigContainer(file = "global.json", config = GlobalConfig.class)
public class GlobalConfigContainer extends BaseConfigContainer<GlobalConfig> {

    private GlobalConfig globalConfig;

    @Override
    protected void buildIndex() {
        // å…¨å±€é…ç½®åªæœ‰ä¸€æ¡
        globalConfig = get(1);
        if (globalConfig == null && !getAll().isEmpty()) {
            globalConfig = getAll().get(0);
        }
    }

    // ==================== æŸ¥è¯¢æ–¹æ³• ====================

    /**
     * è·å–å…¨å±€é…ç½®
     */
    public GlobalConfig getGlobal() {
        return globalConfig;
    }

    /**
     * è·å–æœ€å¤§ç­‰çº§
     */
    public int getMaxLevel() {
        return globalConfig != null ? globalConfig.getMaxLevel() : 100;
    }

    /**
     * è·å–å…¬ä¼šåˆ›å»ºç­‰çº§è¦æ±‚
     */
    public int getGuildCreateLevel() {
        return globalConfig != null ? globalConfig.getGuildCreateLevel() : 20;
    }

    /**
     * è·å–å…¬ä¼šåˆ›å»ºæ¶ˆè€—
     */
    public int getGuildCreateCost() {
        return globalConfig != null ? globalConfig.getGuildCreateCost() : 500;
    }

    /**
     * æ˜¯å¦å¼€å¯æ–°æ‰‹å¼•å¯¼
     */
    public boolean isTutorialEnabled() {
        return globalConfig != null && globalConfig.isTutorialEnabled();
    }
}
```

---

## é…ç½®åŠ è½½

### 1. è‡ªåŠ¨åŠ è½½

å¯åŠ¨æ—¶è‡ªåŠ¨æ‰«æå¹¶åŠ è½½æ‰€æœ‰ `@ConfigContainer` æ ‡æ³¨çš„å®¹å™¨ï¼š

```java
// æ¡†æ¶è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨è°ƒç”¨
// 1. æ‰«ææ‰€æœ‰ @ConfigContainer æ³¨è§£çš„ç±»
// 2. è¯»å–å¯¹åº”çš„ JSON æ–‡ä»¶
// 3. è§£æå¹¶å¡«å……æ•°æ®
// 4. è°ƒç”¨ buildIndex() æ„å»ºç´¢å¼•
```

### 2. JSON æ–‡ä»¶æ ¼å¼

`config/item.json`:

```json
[
  {
    "id": 1001,
    "name": "å°è¡€ç“¶",
    "type": 4,
    "quality": 1,
    "maxStack": 99,
    "sellPrice": 10,
    "tradeable": true,
    "effect": "{\"hp\": 100}",
    "icon": "item_1001",
    "desc": "æ¢å¤100ç‚¹ç”Ÿå‘½å€¼"
  },
  {
    "id": 1002,
    "name": "ä¸­è¡€ç“¶",
    "type": 4,
    "quality": 2,
    "maxStack": 99,
    "sellPrice": 50,
    "tradeable": true,
    "effect": "{\"hp\": 500}",
    "icon": "item_1002",
    "desc": "æ¢å¤500ç‚¹ç”Ÿå‘½å€¼"
  }
]
```

`config/global.json`:

```json
[
  {
    "id": 1,
    "gameName": "XXæ‰‹æ¸¸",
    "maxLevel": 100,
    "dailyLoginRewardId": 10001,
    "tutorialEnabled": true,
    "maxVipLevel": 15,
    "guildCreateLevel": 20,
    "guildCreateCost": 500
  }
]
```

### 3. åœ¨ä¸šåŠ¡ä¸­ä½¿ç”¨

```java
@Service
@RequiredArgsConstructor
public class ItemService {

    private final ItemConfigContainer itemConfigContainer;
    private final LevelConfigContainer levelConfigContainer;
    private final GlobalConfigContainer globalConfigContainer;

    /**
     * ä½¿ç”¨ç‰©å“
     */
    public void useItem(long roleId, int itemId, int count) {
        // è·å–ç‰©å“é…ç½®
        ItemConfig config = itemConfigContainer.getItem(itemId);
        if (config == null) {
            throw new BizException(ErrorCode.ITEM_NOT_EXIST);
        }
        
        // æ£€æŸ¥æ˜¯å¦æ˜¯æ¶ˆè€—å“
        if (!config.isConsumable()) {
            throw new BizException(ErrorCode.ITEM_CANNOT_USE);
        }
        
        // ä½¿ç”¨ç‰©å“
        applyEffect(roleId, config.getEffect(), count);
    }

    /**
     * å‡çº§
     */
    public void levelUp(long roleId, int currentLevel, long currentExp) {
        // è·å–å‡çº§æ‰€éœ€ç»éªŒ
        long expRequired = levelConfigContainer.getExpRequired(currentLevel + 1);
        
        // æ£€æŸ¥æœ€å¤§ç­‰çº§
        int maxLevel = globalConfigContainer.getMaxLevel();
        if (currentLevel >= maxLevel) {
            throw new BizException(ErrorCode.ALREADY_MAX_LEVEL);
        }
        
        // æ£€æŸ¥ç»éªŒæ˜¯å¦è¶³å¤Ÿ
        if (currentExp < expRequired) {
            throw new BizException(ErrorCode.EXP_NOT_ENOUGH);
        }
        
        // æ‰§è¡Œå‡çº§
        doLevelUp(roleId);
    }
}
```

---

## é…ç½®çƒ­æ›´æ–°

### 1. GM å‘½ä»¤çƒ­æ›´æ–°

```java
package com.game.service.gm.controller;

import com.game.core.config.game.ConfigLoader;
import com.game.common.result.Result;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.*;

@Slf4j
@RestController
@RequestMapping("/gm/config")
@RequiredArgsConstructor
public class GmConfigController {

    private final ConfigLoader configLoader;

    /**
     * é‡æ–°åŠ è½½æ‰€æœ‰é…ç½®
     */
    @PostMapping("/reload")
    public Result<Void> reloadAll() {
        log.info("GM é‡æ–°åŠ è½½æ‰€æœ‰é…ç½®");
        configLoader.reloadAll();
        return Result.success();
    }

    /**
     * é‡æ–°åŠ è½½æŒ‡å®šé…ç½®
     */
    @PostMapping("/reload/{configName}")
    public Result<Void> reload(@PathVariable String configName) {
        log.info("GM é‡æ–°åŠ è½½é…ç½®: {}", configName);
        configLoader.reload(configName);
        return Result.success();
    }

    /**
     * è·å–é…ç½®ç‰ˆæœ¬
     */
    @GetMapping("/version")
    public Result<Map<String, String>> getVersions() {
        return Result.success(configLoader.getVersions());
    }
}
```

### 2. é…ç½®æ›´æ–°ç›‘å¬

```java
@Component
@RequiredArgsConstructor
public class ConfigUpdateListener {

    private final ItemConfigContainer itemConfigContainer;

    /**
     * ç›‘å¬é…ç½®é‡è½½äº‹ä»¶
     */
    @EventListener
    public void onConfigReload(ConfigReloadEvent event) {
        log.info("é…ç½®å·²é‡è½½: {}", event.getConfigName());
        
        // å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›é…ç½®æ›´æ–°åçš„å¤„ç†
        if ("item".equals(event.getConfigName())) {
            // ç‰©å“é…ç½®æ›´æ–°åçš„å¤„ç†
            log.info("ç‰©å“é…ç½®å·²æ›´æ–°ï¼Œå…± {} ä¸ªç‰©å“", 
                    itemConfigContainer.getAll().size());
        }
    }
}
```

### 3. é›†ç¾¤é…ç½®åŒæ­¥

```java
@Service
@RequiredArgsConstructor
public class ConfigSyncService {

    private final ConfigLoader configLoader;
    private final DistributedEventBus distributedEventBus;

    /**
     * é‡è½½é…ç½®å¹¶åŒæ­¥åˆ°é›†ç¾¤
     */
    public void reloadAndSync(String configName) {
        // 1. æœ¬åœ°é‡è½½
        configLoader.reload(configName);
        
        // 2. å‘å¸ƒäº‹ä»¶ï¼Œé€šçŸ¥å…¶ä»–æœåŠ¡
        distributedEventBus.publishGlobal("config:reload", configName);
    }

    /**
     * é‡è½½æ‰€æœ‰é…ç½®å¹¶åŒæ­¥
     */
    public void reloadAllAndSync() {
        configLoader.reloadAll();
        distributedEventBus.publishGlobal("config:reload", "ALL");
    }
}
```

---

## æœ€ä½³å®è·µ

### 1. é…ç½®æ ¡éªŒ

```java
@Component
@ConfigContainer(file = "item.json", config = ItemConfig.class)
public class ItemConfigContainer extends BaseConfigContainer<ItemConfig> {

    @Override
    protected void validate() {
        for (ItemConfig config : getAll()) {
            // æ£€æŸ¥å¿…å¡«å­—æ®µ
            if (config.getName() == null || config.getName().isEmpty()) {
                throw new IllegalStateException("ç‰©å“åç§°ä¸èƒ½ä¸ºç©º: id=" + config.getId());
            }
            
            // æ£€æŸ¥æ•°å€¼èŒƒå›´
            if (config.getMaxStack() <= 0) {
                throw new IllegalStateException("æœ€å¤§å †å æ•°å¿…é¡»å¤§äº0: id=" + config.getId());
            }
            
            // æ£€æŸ¥å¼•ç”¨å®Œæ•´æ€§
            // ...
        }
    }
}
```

### 2. é…ç½®ç´¢å¼•

```java
@Component
@ConfigContainer(file = "monster.json", config = MonsterConfig.class)
public class MonsterConfigContainer extends BaseConfigContainer<MonsterConfig> {

    // æŒ‰åœºæ™¯ç´¢å¼•
    private Map<Integer, List<MonsterConfig>> byScene;
    
    // æŒ‰ç±»å‹ç´¢å¼•
    private Map<Integer, List<MonsterConfig>> byType;
    
    // æŒ‰ç­‰çº§èŒƒå›´ç´¢å¼•
    private Map<Integer, List<MonsterConfig>> byLevelRange;

    @Override
    protected void buildIndex() {
        byScene = getAll().stream()
                .collect(Collectors.groupingBy(MonsterConfig::getSceneId));
        
        byType = getAll().stream()
                .collect(Collectors.groupingBy(MonsterConfig::getType));
        
        // æŒ‰ç­‰çº§åŒºé—´ç´¢å¼• (æ¯10çº§ä¸€æ¡£)
        byLevelRange = getAll().stream()
                .collect(Collectors.groupingBy(m -> m.getLevel() / 10));
    }

    public List<MonsterConfig> getByScene(int sceneId) {
        return byScene.getOrDefault(sceneId, List.of());
    }

    public List<MonsterConfig> getByLevelRange(int level) {
        return byLevelRange.getOrDefault(level / 10, List.of());
    }
}
```

### 3. é…ç½®ç›®å½•ç»“æ„

```
config/
â”œâ”€â”€ base/                    # åŸºç¡€é…ç½®
â”‚   â”œâ”€â”€ global.json
â”‚   â””â”€â”€ constant.json
â”œâ”€â”€ item/                    # ç‰©å“ç›¸å…³
â”‚   â”œâ”€â”€ item.json
â”‚   â”œâ”€â”€ equipment.json
â”‚   â””â”€â”€ consumable.json
â”œâ”€â”€ character/               # è§’è‰²ç›¸å…³
â”‚   â”œâ”€â”€ level.json
â”‚   â”œâ”€â”€ attribute.json
â”‚   â””â”€â”€ skill.json
â”œâ”€â”€ monster/                 # æ€ªç‰©ç›¸å…³
â”‚   â”œâ”€â”€ monster.json
â”‚   â””â”€â”€ boss.json
â”œâ”€â”€ dungeon/                 # å‰¯æœ¬ç›¸å…³
â”‚   â”œâ”€â”€ dungeon.json
â”‚   â””â”€â”€ reward.json
â””â”€â”€ activity/                # æ´»åŠ¨ç›¸å…³
    â”œâ”€â”€ activity.json
    â””â”€â”€ event.json
```

### 4. é…ç½®ç±»å‘½åè§„èŒƒ

| ç±»å‹ | é…ç½®ç±» | å®¹å™¨ç±» | JSONæ–‡ä»¶ |
|-----|-------|--------|---------|
| ç‰©å“ | ItemConfig | ItemConfigContainer | item.json |
| ç­‰çº§ | LevelConfig | LevelConfigContainer | level.json |
| æ€ªç‰© | MonsterConfig | MonsterConfigContainer | monster.json |
| æŠ€èƒ½ | SkillConfig | SkillConfigContainer | skill.json |

---

## å¸¸è§é—®é¢˜

### Q1: é…ç½®åŠ è½½å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

```java
// æ¡†æ¶ä¼šåœ¨å¯åŠ¨æ—¶æ ¡éªŒé…ç½®
// 1. æ£€æŸ¥ JSON æ ¼å¼æ˜¯å¦æ­£ç¡®
// 2. æ£€æŸ¥å­—æ®µç±»å‹æ˜¯å¦åŒ¹é…
// 3. æ£€æŸ¥ validate() æ–¹æ³•

// æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
// [ERROR] é…ç½®åŠ è½½å¤±è´¥: item.json - JSON parse error at line 10
```

### Q2: å¦‚ä½•å¤„ç†é…ç½®çƒ­æ›´åçš„ç¼“å­˜ï¼Ÿ

```java
@EventListener
public void onConfigReload(ConfigReloadEvent event) {
    // æ¸…ç†ç›¸å…³ç¼“å­˜
    cacheService.evict("item:*");
    
    // é€šçŸ¥åœ¨çº¿ç©å®¶åˆ·æ–°
    pushService.broadcast(MethodId.PUSH_CONFIG_UPDATED, 
            S2C_ConfigUpdated.newBuilder()
                    .setConfigName(event.getConfigName())
                    .build());
}
```

### Q3: å¤§é‡é…ç½®å¦‚ä½•ä¼˜åŒ–åŠ è½½é€Ÿåº¦ï¼Ÿ

```java
// 1. å¼‚æ­¥å¹¶è¡ŒåŠ è½½
configLoader.reloadAllAsync();

// 2. å¢é‡åŠ è½½ (åªåŠ è½½å˜æ›´çš„é…ç½®)
configLoader.reloadIfChanged("item.json");

// 3. é…ç½®é¢„ç¼–è¯‘ (å°† JSON è½¬ä¸ºäºŒè¿›åˆ¶æ ¼å¼)
// ç”±ç­–åˆ’å·¥å…·åœ¨å¯¼å‡ºæ—¶å¤„ç†
```
